{"version":3,"names":[],"mappings":"","sources":["apis.js"],"sourcesContent":["'use strict';\n\nfunction CardModel() {\n    this.preferred = '';\n    this.api = '';\n    this.info = '';\n    this.logo = '';\n    this.externalUrl = '';\n    this.versions = null;\n    this.markedDescription = '';\n};\n\nCardModel.prototype.fromAPIs = function(apis) {\n    this.preferred = apis.preferred;\n    this.api = apis.versions[this.preferred];\n    this.info = this.api.info;\n    this.externalDocs = this.api.externalDocs || {};\n    this.contact = this.info.contact || {};\n    this.externalUrl = this.externalDocs.url || this.contact.url;\n    this.logo = this.info['x-logo'] || {};\n\n    var versions = [];\n    $.each(apis.versions, function (version, api) {\n        if (version === this.preferred) {\n            return;\n        }\n        versions.push({\n            version: version,\n            swaggerUrl: api.swaggerUrl,\n            swaggerYamlUrl: api.swaggerYamlUrl\n        });\n    });\n\n    this.versions = versions.length ? this.versions : null;\n    this.markedDescription = window.marked(this.info.description || '');\n\n    return this;\n};\n\nif (window.$) {\n  $(document).ready(function () {\n    var cardTemplateSrc = document.querySelector('script[type=\"text/dot-template\"]').innerText;\n    var cardTemplate = window.doT.compile(cardTemplateSrc);\n\n    var updateCards = function(data) {\n        var fragment = $(document.createDocumentFragment());\n        $.each(data, function (name, apis) {\n            var model = new CardModel().fromAPIs(apis);\n            var view = cardTemplate(model);\n            fragment.append($(view));\n        });\n\n        $('#apis-list').append(fragment);\n    };\n\n    var filter = function(data, search) {\n        var result = {};\n        $.each(data, function (name, apis) {\n            if (name.toUpperCase().indexOf(search) >= 0) {\n                result[name] = apis;\n            }\n        });\n        return result;\n    };\n\n    $.ajax({\n      type: \"GET\",\n      url: \"https://api.apis.guru/v2/list.json\",\n      dataType: 'json',\n      cache: false,\n      success: function (data) {\n        updateCards(data);\n\n        var searchInput = $('#search-input')[0];\n        searchInput.addEventListener('keyup', function( ) { \n            $('#apis-list').empty();\n\n            var search = $('#search-input').val().toUpperCase();\n            var result = filter(data, search);\n            updateCards(result);\n        }, false);\n      }\n    });\n  });\n}\n"],"file":"apis.js","sourceRoot":"/source/"}